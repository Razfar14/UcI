<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Untuk Mu</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="world-container">
        
        <section class="gift-section">
            <h1 style="margin-bottom: 20px; z-index: 6;">Tap Kado-nya! üéÅ</h1>
            <div class="gift-container" id="gift" onclick="openGift()">
                <div class="gift-glow"></div>
                <div class="gift-lid"><div class="bow"></div></div>
                <div class="gift-box"></div>
            </div>
            <div class="card-area" id="cardArea"></div>
        </section>

        <section class="cake-section">
            
            <h1 class="wish-text" id="wishText">Make a Wish... ‚ú®</h1>

            <div class="cake-container">
                <div class="cake">
                    <div class="plate"></div>
                    <div class="layer layer-bottom"></div>
                    <div class="layer layer-middle"></div>
                    <div class="layer layer-top"></div>
                    <div class="icing"></div>
                    <div class="drip drip1"></div>
                    <div class="drip drip2"></div>
                    <div class="drip drip3"></div>
                    <div class="candle">
                        <div class="flame"></div>
                        <div class="smoke"></div>
                    </div>
                </div>
            </div>

            <button id="blowButton">Tahan untuk Meniup</button>
            
            <h1 class="final-message" id="finalMsg">üéâ Happy Birthday! üéâ</h1>
        </section>

    </div>

    <script>
        const cardsData = [
            { type: "Hi Kamu! üëã", img: "foto1.jpg", text: "Selamat Ulang Tahun! Semoga harimu menyenangkan." },
            { type: "Terima Kasih üôè", img: "", text: "Sudah menjadi teman yang luar biasa selama ini." },
            { type: "Doa Terbaik ‚ú®", img: "foto2.jpg", text: "Semoga semua impianmu di tahun ini tercapai. Aamiin." },
            { type: "Let's Rock! üé∏", img: "foto_ultah_final.jpg", text: "Tahun ini adalah milikmu. Semangat terus! üéÇ" }
        ];

        const gift = document.getElementById('gift');
        const cardArea = document.getElementById('cardArea');
        const worldContainer = document.getElementById('world-container');
        const blowButton = document.getElementById('blowButton');
        const wishText = document.getElementById('wishText');
        const finalMsg = document.getElementById('finalMsg');
        
        let isGiftOpened = false;
        let cardElements = []; 

        function initCards() {
            cardsData.forEach((data, index) => {
                const card = document.createElement('div');
                card.classList.add('card');
                card.style.zIndex = cardsData.length - index; 
                const imgHTML = data.img ? `<img src="${data.img}" alt="Foto">` : '';
                card.innerHTML = `<h3>${data.type}</h3>${imgHTML}<p>${data.text}</p><div class="tap-hint">Tap untuk lanjut &rarr;</div>`;
                card.onclick = () => handleCardClick(index);
                cardArea.appendChild(card);
                cardElements.push(card);
            });
        }
        initCards();

        function openGift() {
            if (isGiftOpened) return;
            isGiftOpened = true;
            gift.classList.add('shaking');
            setTimeout(() => {
                gift.classList.remove('shaking');
                gift.classList.add('open');
                setTimeout(revealCards, 600);
            }, 1000);
        }

        function revealCards() {
            cardElements.forEach((card, index) => {
                setTimeout(() => {
                    card.classList.add('active');
                    card.style.transform = `translateY(0) rotate(${(Math.random() * 10) - 5}deg)`;
                }, index * 100);
            });
        }

        function handleCardClick(index) {
            cardElements[index].classList.add('swiped');
            if (index === cardsData.length - 1) setTimeout(finishCards, 800);
        }

        function finishCards() {
            worldContainer.classList.add('falling-effect');
            setTimeout(() => {
                worldContainer.classList.remove('falling-effect');
                worldContainer.classList.add('landed-impact');
                setTimeout(() => {
                    wishText.classList.add('show');
                    initBlowFeature();
                }, 500);
            }, 1000);
        }

        function initBlowFeature() {
            let blowTimer;
            const flames = document.querySelectorAll('.flame');
            const smokes = document.querySelectorAll('.smoke');

            function startBlowing(e) {
                e.preventDefault();
                blowButton.style.transform = 'translateX(-50%) scale(0.95)';
                flames.forEach(f => { f.style.transform = "scale(1.2)"; f.style.animationDuration = '0.1s'; });
                blowTimer = setTimeout(() => {
                    flames.forEach(f => f.classList.add('out'));
                    smokes.forEach(s => s.classList.add('rise'));
                    blowButton.style.display = 'none';
                    wishText.style.opacity = 0;
                    finalMsg.style.opacity = 1;
                }, 2000);
            }

            function stopBlowing() {
                clearTimeout(blowTimer);
                blowButton.style.transform = 'translateX(-50%) scale(1)';
                flames.forEach(f => {
                    if (!f.classList.contains('out')) { f.style.transform = "scale(1)"; f.style.animationDuration = '1s'; }
                });
            }

            blowButton.addEventListener('mousedown', startBlowing);
            blowButton.addEventListener('mouseup', stopBlowing);
            blowButton.addEventListener('mouseleave', stopBlowing);
            blowButton.addEventListener('touchstart', startBlowing);
            blowButton.addEventListener('touchend', stopBlowing);
        }
    </script>
</body>
</html>